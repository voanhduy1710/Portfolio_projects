## 📝 Problem Description

Find the number of **premium** and **freemium** users in the dataset. Output the **total number of users** in each group.

## 📊 Data Schema

**`linkedin_users`**

| Column Name      | Data Type |
|------------------|-----------|
| user_id          | integer   |
| subscription_type| string    |

- `user_id`: ID of the user
- `subscription_type`: Either `'premium'` or `'freemium'`

## 💡 Example Output

| subscription_type | total_users |
|-------------------|-------------|
| freemium          | 192         |
| premium           | 56          |

## 💻 SQL Solution
WITH cte AS(
            SELECT  DISTINCT
                    u.user_id,
                    u.acc_id,
                    a.paying_customer,
                    d.date,
                    d.downloads,
            CASE    WHEN paying_customer = 'yes' THEN downloads ELSE 0 END AS pay,
            CASE    WHEN paying_customer = 'no' THEN downloads ELSE 0 END AS non_pay
            FROM ms_user_dimension u
            JOIN ms_acc_dimension a ON u.acc_id=a.acc_id
            JOIN ms_download_facts d ON u.user_id=d.user_id
            ORDER BY date
            )
SELECT  date,
        SUM(non_pay) as non_paying,
        SUM(pay) as paying
        FROM cte
GROUP BY date
HAVING SUM(non_pay) > SUM(pay)
ORDER by date
