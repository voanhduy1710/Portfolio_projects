## ğŸ“ Premium & Fremium Description

Find the number of **premium** and **freemium** users in the dataset. Output the **total number of users** in each group.


## ğŸ“Š Data Schema

<table>
  <tr>
    <td>

<strong>ms_user_dimension</strong>

| Column Name | Data Type |
|-------------|-----------|
| user_id     | integer   |
| acc_id      | integer   |

</td>
<td>

<strong>ms_acc_dimension</strong>

| Column Name       | Data Type |
|-------------------|-----------|
| acc_id            | integer   |
| paying_customer   | string    |

</td>
<td>

<strong>ms_download_facts</strong>

| Column Name | Data Type |
|-------------|-----------|
| user_id     | integer   |
| date        | date      |
| downloads   | integer   |

</td>
  </tr>
</table>

## ğŸ’» SQL Solution

```
WITH cte AS(
            SELECT  DISTINCT
                    u.user_id,
                    u.acc_id,
                    a.paying_customer,
                    d.date,
                    d.downloads,
            CASE    WHEN paying_customer = 'yes' THEN downloads ELSE 0 END AS pay,
            CASE    WHEN paying_customer = 'no' THEN downloads ELSE 0 END AS non_pay
            FROM ms_user_dimension u
            JOIN ms_acc_dimension a ON u.acc_id=a.acc_id
            JOIN ms_download_facts d ON u.user_id=d.user_id
            ORDER BY date
            )
SELECT  date,
        SUM(non_pay) as non_paying,
        SUM(pay) as paying
        FROM cte
GROUP BY date
HAVING SUM(non_pay) > SUM(pay)
ORDER by date


## ğŸ“ Premium Accounts Description

Find the average number of downloads for users who are **premium customers**.  
Only include users who have made **at least one download**.

## ğŸ“Š Data Schema

<table>
  <tr>
    <td>

<strong>ms_user_dimension</strong>

| Column Name | Data Type |
|-------------|-----------|
| user_id     | integer   |
| acc_id      | integer   |

</td>
<td>

<strong>ms_acc_dimension</strong>

| Column Name       | Data Type |
|-------------------|-----------|
| acc_id            | integer   |
| paying_customer   | string    |

</td>
<td>

<strong>ms_download_facts</strong>

| Column Name | Data Type |
|-------------|-----------|
| user_id     | integer   |
| date        | date      |
| downloads   | integer   |

</td>
  </tr>
</table>

## ğŸ’» SQL Solution

```
WITH premium_accounts as (
SELECT
    account_id,
    entry_date,
    final_price
FROM premium_accounts_by_day
WHERE final_price > 0)
SELECT a.entry_date,
COUNT (DISTINCT a.account_id) as premium_paid_accounts,
COUNT (DISTINCT b.account_id) as premium_paid_accounts_after_7d
FROM premium_accounts a
LEFT JOIN premium_accounts b
ON a.account_id = b.account_ID
AND (b.entry_date - a.entry_date) = 7
GROUP BY a.entry_date
ORDER by a.entry_date
LIMIT 7
